{{extend 'layout.html'}}

{{block head}}
<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script>
    var my_url = "{{=URL('api', 'my_method')}}";
    var listings_url = "{{=URL('default', 'get_listings')}}";//No need for signature here
	var get_my_info_url = "{{=URL('default', 'get_my_info')}}";

	var search_url = "{{=URL('default', 'search')}}";
	var like_property_url = "{{=URL('default', 'like_property')}}"

	var like_property_url = "{{=URL('default', 'like_property')}}";
    var get_liked_properties_url = "{{=URL('default', 'get_liked_properties')}}";
    var add_note_url = "{{=URL('api', 'add_new_note',  user_signature=True)}}";

</script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

{{end}}

<div class="main_content">
    <body class="background-pic">
	<div class="content">
    	<div id="vue-div" class="display:none">
			<transition name="fade">
        	<!-- Your code goes here.  Remember to call $("#vue-div").show() once you get the data for the first time. -->
				<div class="home_title">
					<h1 id="slug_title">Slug House</h1>
					<h4>UCSC Housing Registry</h4>
				</div>
				<div>

				</div>

			</transition>

            <div class="padded">
                <div class="padded container">
                    <div class="third">
                        <input class="string" v-model="form_street_search" placeholder="Street" type="text">
                    </div>
                    <div class="third">
                        <input class="string" v-model="form_city_search" placeholder="City" type="text">
                    </div>
                    <div class="third">
                        <input class="string" v-model="form_zip_search" placeholder="Zip Code" type="text">
                    </div>
                    <div class="third">
                        <input class="string" v-model="form_state_search" placeholder="State" type="text">
                    </div>
                    <div class="twothirds">
                        <button v-on:click="search_button()">
                            <i class="fa fa-search"></i> Search
                        </button>
                        <button v-on:click="cancel_search_button()">
                            <i class="fa fa-times"></i> Clear
                        </button>
                    </div>

            <div v-if="listings.length > 0" class="listings padded">
                <h4> Available Listings</h4>
                <div class="padded center">
                    <div class="fa-border" v-for="listing in listings">
                        <div class="padded">
                            <h6> Address</h6>
                            <p>${listing.street}</p>
                            <p>${listing.city} ${listing.state} ${listing.zip}</p>
                        </div>
                        <div class="padded">
                            <h6> description </h6>
                            <p> Bedrooms: ${listing.num_bedrooms}</p>
                            <p> Full Bathrooms:${listing.num_fullbaths}</p>
                            <p> Half Bathrooms: ${listing.num_halfbaths}</p>
                        </div>
                        <div class="padded">
                            <h6> Property Owner </h6>
                            ${listing.user_email}
                        </div>

                        <div class="padded">
                            <button class="btn" v-on:click="see_notes_button()"> See Reviews </button>
                            <div v-if="is_viewing_notes">
                                <h6> Reviews </h6>
                                <div v-for="note in listing.notes">
                                    <div>
                                        ${note.note}
                                        ${note.created_by}
                                        ${note.created_on}
                                    </div>
                                    <div>
                                        <button v-on:click="add_note(note.property_id)"> Submit </button>
                                    </div>
                                </div>
                            </div>
                            <button v-if="is_adding_note" v-on:click="" class="btn"><i class="fa fa-pencil"></i> Leave Review </button>
                        </div>
                        <div class="padded" v-if="logged_in">
                            <button v-show="is_property_liked(listing.property_id) == true" v-on:click="like_property(listing.property_id)">
                                <i class="fas fa-star"></i>
                            </button>
                            <button v-show="is_property_liked(listing.property_id) == false" v-on:click="like_property(listing.property_id)">
                                <i class="far fa-star"></i>
                            </button>
                        </div>


                    </div>
                    <div class="container center padded">
                            <div class="third">
                                <button v-if="has_less" class="center" v-on:click="prev_page()"><i class="fa fa-arrow-left"></i> Prev </button>
                            </div>
                            <div class="third">
                                <p class="center"> ${page} </p>
                            </div>
                            <div class="third">
                                <button v-if="has_more" class="center" v-on:click="next_page()"> Next <i class="fa fa-arrow-right"></i></button>
                            </div>
                        </div>
                    <div v-if="listings.length == 0">
                    <h5> No Results Found </h5>
                </div>
             </div>
            </div>

    </div>
	</body>
</div>


<script src="{{=URL('static', 'js/default_index.js')}}"></script>
